"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const Debug = require("debug");
const debug = Debug('ionic:cli-utils:lib:process');
const calledFns = new Set();
function wrapfn(fn) {
    if (!calledFns.has(fn)) {
        try {
            calledFns.add(fn);
            fn();
        }
        finally {
            process.exit();
        }
    }
}
function registerShutdownFunction(fn) {
    process.on('exit', () => { debug('registerShutdownFunction: process.exit/normal shutdown'); wrapfn(fn); });
    process.on('SIGINT', () => { debug('registerShutdownFunction: SIGINT'); wrapfn(fn); });
    process.on('SIGTERM', () => { debug('registerShutdownFunction: SIGTERM'); wrapfn(fn); });
    process.on('SIGHUP', () => { debug('registerShutdownFunction: SIGHUP'); wrapfn(fn); });
    process.on('SIGBREAK', () => { debug('registerShutdownFunction: SIGBREAK'); wrapfn(fn); });
}
exports.registerShutdownFunction = registerShutdownFunction;
